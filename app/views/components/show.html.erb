<%# decor/app/views/components/show.html.erb - version 1.6 %>
<%# Session 10: Restructured field layout per new spec: %>
<%#   Line 1 (3-col): Computer Model | Computer Order Number | Computer Serial Number %>
<%#   Line 2 (4-col): Component Type | Component Order Number | Component Serial Number | Condition %>
<%#   Line 3 (full):  Description %>
<%# Computer Order Number and Serial Number in Line 1 show the parent computer's values %>
<%# (or "—" when no computer is assigned / the field is blank). %>

<div class="max-w-5xl mx-auto">
  <div class="flex justify-between items-start mb-4">
    <div>
      <h1 class="text-2xl font-semibold"><%= @component.component_type.name %></h1>
      <p class="text-sm text-stone-600">Owned by <%= link_to @component.owner.user_name, @component.owner, class: "font-medium underline text-stone-700 hover:text-stone-900" %></p>
    </div>
    <% if Current.owner == @component.owner || admin? %>
      <div class="flex gap-2">
        <%= link_to "Edit", edit_component_path(@component), class: button_classes(style: :primary) %>
        <%= button_to "Delete", component_path(@component), method: :delete, data: { turbo_confirm: "Are you sure?" }, class: button_classes(style: :secondary) %>
      </div>
    <% end %>
  </div>

  <dl class="space-y-4 text-sm mb-6">

    <%# Line 1 (3-col): Computer Model | Computer Order Number | Computer Serial Number %>
    <%# All three fields describe the parent computer, so they are blank-equivalent ("—") %>
    <%# when the component has no assigned computer. %>
    <div class="grid grid-cols-3 gap-4">
      <div>
        <dt class="text-xs font-medium text-stone-500 uppercase tracking-wider mb-1">Computer Model</dt>
        <%# Clickable indigo link to the computer when assigned; muted "Spare" when not. %>
        <dd class="flex items-center w-full h-10 p-3 rounded border border-stone-300 bg-white text-sm">
          <% if @component.computer %>
            <%= link_to @component.computer.computer_model.name, computer_path(@component.computer), class: "text-indigo-600 hover:text-indigo-900" %>
          <% else %>
            <span class="text-stone-400">Spare</span>
          <% end %>
        </dd>
      </div>
      <div>
        <dt class="text-xs font-medium text-stone-500 uppercase tracking-wider mb-1">Computer Order Number</dt>
        <dd class="flex items-center w-full h-10 p-3 rounded border border-stone-300 bg-white text-sm text-stone-600">
          <%= @component.computer&.order_number.presence || "—" %>
        </dd>
      </div>
      <div>
        <dt class="text-xs font-medium text-stone-500 uppercase tracking-wider mb-1">Computer Serial Number</dt>
        <dd class="flex items-center w-full h-10 p-3 rounded border border-stone-300 bg-white text-sm text-stone-600">
          <%= @component.computer&.serial_number.presence || "—" %>
        </dd>
      </div>
    </div>

    <%# Line 2 (4-col): Component Type | Component Order Number | Component Serial Number | Condition %>
    <div class="grid grid-cols-4 gap-4">
      <div>
        <dt class="text-xs font-medium text-stone-500 uppercase tracking-wider mb-1">Component Type</dt>
        <dd class="flex items-center w-full h-10 p-3 rounded border border-stone-300 bg-white text-sm text-stone-600">
          <%= @component.component_type.name %>
        </dd>
      </div>
      <div>
        <dt class="text-xs font-medium text-stone-500 uppercase tracking-wider mb-1">Component Order Number</dt>
        <dd class="flex items-center w-full h-10 p-3 rounded border border-stone-300 bg-white text-sm text-stone-600">
          <%= @component.order_number.presence || "—" %>
        </dd>
      </div>
      <div>
        <dt class="text-xs font-medium text-stone-500 uppercase tracking-wider mb-1">Component Serial Number</dt>
        <dd class="flex items-center w-full h-10 p-3 rounded border border-stone-300 bg-white text-sm text-stone-600">
          <%= @component.serial_number.presence || "—" %>
        </dd>
      </div>
      <div>
        <dt class="text-xs font-medium text-stone-500 uppercase tracking-wider mb-1">Component Condition</dt>
        <dd class="flex items-center w-full h-10 p-3 rounded border border-stone-300 bg-white text-sm text-stone-600">
          <%= @component.component_condition&.condition || "—" %>
        </dd>
      </div>
    </div>

    <%# Line 3 (full): Description — whitespace-pre-wrap to preserve line breaks. %>
    <%# ERB tag is on the same line as <dd> — whitespace-pre-wrap renders leading %>
    <%# newlines/indentation literally, which would cause unwanted left indentation. %>
    <div>
      <dt class="text-xs font-medium text-stone-500 uppercase tracking-wider mb-1">Component Description</dt>
      <dd class="block w-full p-3 rounded border border-stone-300 bg-white text-sm text-stone-600 whitespace-pre-wrap" style="min-height: 4.5rem;"><%= @component.description.presence || "—" %></dd>
    </div>

  </dl>

  <%# Smart Back button — Stimulus back_controller.js %>
  <%# Primary: history.back() (returns to wherever the user came from). %>
  <%# Fallback when history is empty: computer page if assigned, else owner page. %>
  <% fallback_url = @component.computer ? computer_path(@component.computer) : owner_path(@component.owner) %>
  <div class="mt-6">
    <a href="#"
       data-controller="back"
       data-back-fallback-url-value="<%= fallback_url %>"
       data-action="click->back#go"
       class="text-sm text-stone-700 hover:text-stone-900">← Back</a>
  </div>
</div>
